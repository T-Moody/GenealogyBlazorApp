@using GenealogyBlazorApp.Client.Features.Home.Models

<div class="text-center mb-4">
    <div class="profile-image-container">
        @if (!string.IsNullOrEmpty(State.ProfileImagePath))
        {
            <img src="@State.ProfileImagePath" alt="Profile Image" class="img-fluid rounded-circle" />
        }
        else if (IsEditor)
        {
             <div class="profile-placeholder rounded-circle d-flex align-items-center justify-content-center" style="width: 150px; height: 150px; background: #eee; border: 2px dashed #ccc;">
                <span class="text-muted">No Image</span>
            </div>
        }
        
        <div class="profile-image-caption">
            @if (IsEditor)
            {
                <input type="text" class="form-control form-control-sm text-center mt-1" @bind="State.ProfileImageCaption" placeholder="Caption" />
            }
            else
            {
                @State.ProfileImageCaption
            }
        </div>
    </div>
    
    @if (IsEditor)
    {
        <div class="mt-2">
            <input type="text" class="form-control form-control-sm text-center" @bind="State.ProfileImagePath" placeholder="Profile Image Path" />
        </div>
    }
</div>

<div class="sidebar-section mt-5">
    <h4 class="text-center mb-3 vintage-header">Resources</h4>
    
    @if (!IsEditor)
    {
        <div class="text-center">
            <p class="text-muted small mb-3">Explore our curated collection of external genealogy repositories.</p>
            <a href="resources" class="btn btn-vintage-outline btn-sm">View Archives</a>
        </div>
    }
    else
    {
        <ul class="list-unstyled text-center sidebar-links opacity-50">
            @foreach (var link in State.Links.Take(3))
            {
                <li class="mb-2">
                    <span class="vintage-link">@link.Title</span>
                </li>
            }
            @if (State.Links.Count > 3)
            {
                <li class="text-muted small">...and @(State.Links.Count - 3) more</li>
            }
        </ul>
    }

    @if (IsEditor)
    {
        <div class="mt-3 p-3 border rounded bg-light text-start">
            <h6 class="text-center mb-3">Edit Resource Links</h6>
            <p class="small text-muted text-center mb-2">These links appear on the Resources page.</p>
            @foreach (var link in State.Links)
            {
                <div class="mb-2 row g-1">
                    <div class="col-5">
                        <input type="text" class="form-control form-control-sm" @bind="link.Title" placeholder="Title" />
                    </div>
                    <div class="col-6">
                        <input type="text" class="form-control form-control-sm" @bind="link.Url" placeholder="URL" />
                    </div>
                    <div class="col-1">
                        <button class="btn btn-sm btn-outline-danger" @onclick="() => State.Links.Remove(link)">Ã—</button>
                    </div>
                </div>
            }
            <div class="text-center mt-2">
                <button class="btn btn-sm btn-outline-secondary" @onclick='() => State.Links.Add(new LinkModel { Title = "New Link", Url = "#" })'>+ Add Link</button>
            </div>
        </div>
    }
</div>